{% extends "base.html" %}

{% block title %}Custom Fields â€” {{ site.product_name|default:"KoNote" }}{% endblock %}

{% block content %}
<hgroup>
    <h1>Custom Fields</h1>
    <p>Define additional fields for {{ term.client|default:"client" }} files.</p>
</hgroup>

<div role="group">
    <a href="{% url 'clients:custom_field_group_create' %}" role="button">New Group</a>
    <a href="{% url 'clients:custom_field_def_create' %}" role="button" class="outline">New Field</a>
</div>

{% if groups %}
{% for group in groups %}
<article>
    <header>
        <strong>{{ group.title }}</strong>
        {% if group.status == "archived" %}<span class="badge badge-neutral">Archived</span>{% endif %}
        <span style="float: right;">
            <a href="{% url 'clients:custom_field_group_edit' group_id=group.pk %}">Edit Group</a>
        </span>
    </header>
    {% if group.fields.all %}
    <table role="grid">
        <thead>
            <tr>
                <th>Field</th>
                <th>Type</th>
                <th>Required</th>
                <th>Sensitive</th>
                <th></th>
            </tr>
        </thead>
        <tbody>
            {% for field in group.fields.all %}
            <tr>
                <td>{{ field.name }}</td>
                <td>{{ field.get_input_type_display }}</td>
                <td>{% if field.is_required %}Yes{% else %}No{% endif %}</td>
                <td>{% if field.is_sensitive %}Yes{% else %}No{% endif %}</td>
                <td><a href="{% url 'clients:custom_field_def_edit' field_id=field.pk %}">Edit</a></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="empty-state">No fields in this group yet.</p>
    {% endif %}
</article>
{% endfor %}
{% else %}
<div class="empty-state">
    <p>No custom field groups defined yet.</p>
</div>
{% endif %}
{% endblock %}
